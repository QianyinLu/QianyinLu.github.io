Title: Python Visualization - Malaria Dataset
Category: Plot 
Date: 2020-09-22 10:01
Modified: 2020-09-22 12:30
Tags: matplotlib, python, visualization
Slug: plot
Authors: Presnie Lu
Summary: 3 figures generated by python with Malaria Dataset

**This Blog will include 3 informative visualizations about malaria using Python. I will use Malaria Dataset from [github](https://github.com/rfordatascience/tidytuesday/tree/master/data/2018/2018-11-13) to generate the plots.**

# Figure 1

This first plot shows the total incidence number of malaria in year 2000, 2005, 2010 and 2015 for the Top five countries with the highest average malaria incidences. The stacked bar chart is used to differentiate the yearly composition as well as compare the total number of incidence for these countries. The dataset used in this plot is [malaria_inc.csv](https://github.com/rfordatascience/tidytuesday/blob/master/data/2018/2018-11-13/malaria_inc.csv) and python code is provided below. Note this first plot is from the country level.  
    
    :::python
    #import data
    inc = pd.read_csv("malaria_inc.csv")
    inc.columns = ['Entity', 'Code', 'Year','Incidence of malaria (per 1,000 population at risk)']
    
    #filter out the country level data only
    inc_country = inc[inc.Code.notna()]
    inc_country = inc_country[inc_country.Code != "OWID_WRL"]
    
    #find the top 5 countries with highest average incidences
    inc_avg = inc_country.groupby(by = "Entity").agg({"Incidence of malaria (per 1,000 population at risk)":"mean"}).reset_index()
    top5 = inc_avg.sort_values("Incidence of malaria (per 1,000 population at risk)", ascending = False).Entity.head(5)
    data = inc[inc.Entity.isin(top5)][["Entity","Year", "Incidence of malaria (per 1,000 population at risk)"]]
    transformed = data.pivot(index = "Entity", columns = "Year", values = "Incidence of malaria (per 1,000 population at risk)")
    
    #plot
    pal = sns.color_palette("Set1")
    transformed.plot(kind = "bar", stacked = True, figsize = (12,6), color = pal, alpha = 0.6)
    plt.xticks(rotation=0, size=10)
    plt.ylim((0,2500))
    plt.xlabel("Country", fontdict = {'fontsize' : 14})
    plt.ylabel("Incidence of malaria (per 1,000 population at risk)", fontdict = {'fontsize' : 14})
    plt.title("Incidence of Malaria for the 5 Highest Country (Average) group by Year", fontdict = {'fontsize' : 18})
    plt.show()
    
    
![Incidence of Malaria](/img/plot1.png "Incidence of Malaria")

# Figure 2

The second plot shows the Death Rate of Malaria for the 5 Highest Average Death Rate Regions. In this plot, I used boxplot to include death rates of malaria for these regions for all years so that we can not only compare the average death rate but also the max/min and different quantiles of death rate over years based on more than 20 years of data. The dataset used in this plot is [malaria_deaths.csv](https://github.com/rfordatascience/tidytuesday/blob/master/data/2018/2018-11-13/malaria_deaths.csv) and python code is provided below. Note this first plot is from the regional(continent) level.  

    :::python
    #import data
    death = pd.read_csv("malaria_deaths.csv")
    death.columns = ["Entity", "Code", "Year", "Death Rate(per 100,000 people)"]
    
    #Filter out Regions only
    continent = death[death.Code.isnull()]
    
    # Find out the top five continents with highest average
    group = continent.groupby("Entity")
    chosen = group.agg({"Death Rate(per 100,000 people)": "mean"}).sort_values('Death Rate(per 100,000 people)', ascending=False).reset_index().head(5)
    subgroup = continent[continent.Entity.isin(chosen.Entity)]
    subgroup = subgroup[["Entity", "Death Rate(per 100,000 people)"]]
    
    #plot
    plt.figure(figsize = (12,7))
    sns.boxplot(x="Entity", y="Death Rate(per 100,000 people)", data=subgroup)
    plt.title("Boxplot of Death Rate Over Years for the 5 Highest Average Death Rate Regions", fontdict = {'fontsize' : 18})
    plt.xlabel("Region", fontdict = {'fontsize' : 14})
    plt.ylabel("Death Rate(per 100,000 people)", fontdict = {'fontsize' : 14})plt.figure(figsize = (12,7))
    
![Death Rate of Regions](/img/plot2.png "Boxplot of Death Rate for Regions")

# Figure 3

The third plot shows the overall deaths caused by malaria worldwide and the age decomposition of the deaths over years. I used stacked area plot to illustrate the trend difference and overall composition of age group. It is obvious to see that the general trend of all age groups are quite similar over years and the under 5 years old group has always been the largest. The dataset used in this plot is [malaria_deaths_age.csv](https://github.com/rfordatascience/tidytuesday/blob/master/data/2018/2018-11-13/malaria_deaths_age.csv) and python code is provided below. Note this first plot is from the world(aggregate all) level.  

    :::python
    #import data
    death_age = pd.read_csv("malaria_deaths_age.csv", index_col = 0)
    
    #Filter out only world data
    death_age_world = death_age[death_age.code == "OWID_WRL"]
    
    #Give order to age_group
    death_age_world.age_group = death_age_world.age_group.astype('category')
    death_age_world.age_group = death_age_world.age_group.cat.reorder_categories(['Under 5', '5-14', '15-49','50-69', '70 or older'], ordered=True)
    
    #Reorder the data
    death_age_world = death_age_world.sort_values(by = ["age_group", "year"])
    
    #plot
    fig, ax = plt.subplots(figsize=(10, 6)) 
    pal = sns.color_palette("Set1")
    ax.stackplot(list(set(death_age_world.year)), death_age_world.deaths.values.reshape((-1,27)), 
              labels = ['Under 5', '5-14', '15-49','50-69', '70 or older'], colors=pal, alpha=0.5)
    ax.legend()
    ax.set_yticklabels(['{:,}'.format(int(x)) for x in ax.get_yticks().tolist()])
    ax.set_ylim([0,1100000])
    ax.set_ylabel("Deaths", fontsize = 14)
    ax.set_xlabel("Year", fontsize = 14)
    ax.set_title("World Malaria Deaths over time group by Age", fontsize = 18)

![World Deaths Group By Age](/img/plot3.png "World Deaths Group By Age")  

These above are the plots and code I generate for the Malaria dataset. Please feel free to contact me if you have any questions. 